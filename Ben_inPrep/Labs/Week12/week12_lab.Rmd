---
title: "week12_lab"
output: html_document
date: "2023-11-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidymodels)
library(tidyverse)
library(parsnip)
library(dslabs)
library(brulee)
```


```{r}
rm(list = ls(all = TRUE))

mnist = read_mnist()

mnist$test$images = mnist$test$images/max(mnist$test$images)
mnist$train$images = mnist$train$images/max(mnist$train$images)

```

#with brulee_mlp(), x can be a recipe. Maybe I can use that to make the input convolutional?

```{r}
img1 = mnist$train$images[5,] %>% as_tibble() %>% transform(y = rev(rep(1:28,each=28)), x = rep(1:28, times = 28))#%>% matrix(nrow=28,ncol=28) 

ggplot(img1, aes(x = x, y = y)) +
    geom_tile(aes(fill=value))

```
```{r}
for(i in 1:(28-3)){
  for(j in 1:(28-3)){
    filt_data = cur_data %>% filter((x <= i +2) & (x >= i) & (y <= j +2) & (y >= j))
    
    tmp = mnist$train$images[5,] %>% matrix(nrow=28) 
    tmp2=flat(tmp[i:(1+2),j:(j+2)])
  }
}
```

